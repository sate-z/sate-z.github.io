<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Docker基本命令 | SateZheng</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Docker基本命令</h1><a id="logo" href="/.">SateZheng</a><p class="description">多读书，多看报，少吃零食，多睡觉</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Docker基本命令</h1><div class="post-meta">Dec 15, 2016<span> | </span><span class="category"><a href="/categories/Docker/">Docker</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker的导入导出操作"><span class="toc-number">1.</span> <span class="toc-text">docker的导入导出操作</span></a></li></ol></div></div><div class="post-content"><p><strong>docker version</strong> ：查看docker的版本号，包括客户端、服务端、依赖的Go等</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]# docker <span class="keyword">version</span></div><div class="line">Client:</div><div class="line"> <span class="keyword">Version</span>:      1.8.2-el7.centos</div><div class="line"> API <span class="keyword">version</span>:  1.20</div><div class="line"> Package <span class="keyword">Version</span>: docker-1.8.2-10.el7.centos.x86_64</div><div class="line"> Go <span class="keyword">version</span>:   go1.4.2</div><div class="line"> Git commit:   a01dc02/1.8.2</div><div class="line"> Built:        </div><div class="line"> OS/<span class="keyword">Arch</span>:      linux/amd64</div><div class="line"></div><div class="line">Server:</div><div class="line"> <span class="keyword">Version</span>:      1.8.2-el7.centos</div><div class="line"> API <span class="keyword">version</span>:  1.20</div><div class="line"> Package <span class="keyword">Version</span>: </div><div class="line"> Go <span class="keyword">version</span>:   go1.4.2</div><div class="line"> Git commit:   a01dc02/1.8.2</div><div class="line"> Built:        </div><div class="line"> OS/<span class="keyword">Arch</span>:      linux/amd64</div></pre></td></tr></table></figure>
<p><strong>docker info</strong>:查看系统(docker)层面信息，包括管理的images, containers数等</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker info</span></div><div class="line"><span class="symbol">Containers:</span> <span class="number">1</span></div><div class="line"><span class="symbol">Images:</span> <span class="number">4</span></div><div class="line">Storage <span class="symbol">Driver:</span> devicemapper</div><div class="line"> Pool <span class="symbol">Name:</span> docker-<span class="number">8</span>:<span class="number">3</span>-<span class="number">36786088</span>-pool</div><div class="line"> Pool <span class="symbol">Blocksize:</span> <span class="number">65.54</span> kB</div><div class="line"> Backing <span class="symbol">Filesystem:</span> xfs</div><div class="line"> Data <span class="symbol">file:</span> /dev/loop0</div><div class="line"> Metadata <span class="symbol">file:</span> /dev/loop1</div><div class="line"> Data Space <span class="symbol">Used:</span> <span class="number">2.059</span> GB</div><div class="line"> Data Space <span class="symbol">Total:</span> <span class="number">107.4</span> GB</div><div class="line"> Data Space <span class="symbol">Available:</span> <span class="number">12.93</span> GB</div><div class="line"> Metadata Space <span class="symbol">Used:</span> <span class="number">1.765</span> MB</div><div class="line"> Metadata Space <span class="symbol">Total:</span> <span class="number">2.147</span> GB</div><div class="line"> Metadata Space <span class="symbol">Available:</span> <span class="number">2.146</span> GB</div><div class="line"> Udev Sync <span class="symbol">Supported:</span> <span class="literal">true</span></div><div class="line"> Deferred Removal <span class="symbol">Enabled:</span> <span class="literal">false</span></div><div class="line"> Data loop <span class="symbol">file:</span> /var/<span class="class"><span class="keyword">lib</span>/<span class="title">docker</span>/<span class="title">devicemapper</span>/<span class="title">devicemapper</span>/<span class="title">data</span></span></div><div class="line"> Metadata loop <span class="symbol">file:</span> /var/<span class="class"><span class="keyword">lib</span>/<span class="title">docker</span>/<span class="title">devicemapper</span>/<span class="title">devicemapper</span>/<span class="title">metadata</span></span></div><div class="line"> Library <span class="symbol">Version:</span> <span class="number">1.02</span>.<span class="number">107</span>-RHEL7 (<span class="number">2015</span>-<span class="number">10</span>-<span class="number">14</span>)</div><div class="line">Execution <span class="symbol">Driver:</span> native-<span class="number">0.2</span></div><div class="line">Logging <span class="symbol">Driver:</span> json-file</div><div class="line">Kernel <span class="symbol">Version:</span> <span class="number">3.10</span>.<span class="number">0</span>-<span class="number">327</span>.el7.x86_64</div><div class="line">Operating <span class="symbol">System:</span> CentOS Linux <span class="number">7</span> (Core)</div><div class="line"><span class="symbol">CPUs:</span> <span class="number">1</span></div><div class="line">Total <span class="symbol">Memory:</span> <span class="number">977.9</span> MiB</div><div class="line"><span class="symbol">Name:</span> centos7</div><div class="line"><span class="symbol">ID:</span> <span class="symbol">BUKD:</span><span class="symbol">MUW2:</span><span class="number">5</span><span class="symbol">X2D:</span><span class="symbol">G7BF:</span><span class="number">6</span><span class="symbol">Y7G:</span><span class="symbol">SKIH:</span><span class="symbol">LD6K:</span><span class="symbol">VUAC:</span><span class="number">3</span><span class="symbol">QA4:</span><span class="symbol">JY5C:</span><span class="symbol">S3DG:</span>LFT2</div><div class="line"><span class="symbol">WARNING:</span> bridge-nf-call-iptables is disabled</div><div class="line"><span class="symbol">WARNING:</span> bridge-nf-call-ip6tables is disabled</div></pre></td></tr></table></figure>
<p><strong>search 搜索镜像</strong>：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]# docker search ubuntu12<span class="number">.10</span></div><div class="line">INDEX       NAME                                  DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</div><div class="line">docker.io   docker.io/chug/ubuntu12<span class="number">.10</span>x32         Ubuntu Quantal Quetzal <span class="number">12.10</span> <span class="number">32</span>bit  base i...   <span class="number">0</span>                    </div><div class="line">docker.io   docker.io/chug/ubuntu12<span class="number">.10</span>x64         Ubuntu Quantal Quetzal <span class="number">12.10</span> <span class="number">64</span>bit  base i...   <span class="number">0</span>                    </div><div class="line">docker.io   docker.io/marcgibbons/ubuntu12<span class="number">.10</span>                                                     <span class="number">0</span>                    </div><div class="line">docker.io   docker.io/mirolin/ubuntu12<span class="number">.10</span>                                                         <span class="number">0</span>                    </div><div class="line">docker.io   docker.io/mirolin/ubuntu12<span class="number">.10</span>_redis                                                   <span class="number">0</span></div></pre></td></tr></table></figure>
<p><strong>pull 下载镜像</strong>：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker pull ubuntu</span></div></pre></td></tr></table></figure>
<p><strong>run 使用镜像创建容器</strong>：</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker run ubuntu /bin/echo hello world</span></div></pre></td></tr></table></figure>
<p><strong>run 创建容器，并交互式的运行</strong>：<br>这里会创建一个新的容器。</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker run -i -t ubuntu /bin/bash</span></div><div class="line">root@c43c7d102baa:/<span class="comment"># cat /etc/issue</span></div><div class="line">Ubuntu <span class="number">14.04</span>.<span class="number">3</span> LTS <span class="string">\n</span> <span class="string">\l</span></div><div class="line"><span class="comment"># -t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上， -i 则让容器的标准输入保持打开</span></div></pre></td></tr></table></figure>
<p>当利用 docker run 来创建容器时，Docker 在后台运行的标准操作包括：</p>
<ul>
<li>检查本地是否存在指定的镜像，不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统，并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去</li>
<li>从地址池配置一个 ip 地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ul>
<p><strong>run -d 守护态运行</strong>：<br>更多的时候，需要让 Docker 容器在后台以守护态（Daemonized）形式运行。此时，可以通过添加 -d 参数来实现。<br>例如下面的命令会在后台运行容器。</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker run -d ubuntu /bin/bash -c <span class="string">"while true;do echo hello world;sleep 1;done"</span></span></div></pre></td></tr></table></figure>
<p><strong>logs 查看容器的运行</strong>：</p>
<p>以上个例子为前导。<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker logs 4f34f95b6abc</span></div><div class="line">hello world</div><div class="line">hello world</div><div class="line">hello world</div><div class="line">hello world</div><div class="line">hello world</div><div class="line">hello world</div><div class="line">hello world</div></pre></td></tr></table></figure></p>
<p><strong>ps 查看容器</strong>：</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]# docker ps -h</div><div class="line"></div><div class="line">Usage:	docker ps [OPTIONS]</div><div class="line"></div><div class="line">List containers</div><div class="line"></div><div class="line">  -<span class="ruby">a, --all=<span class="literal">false</span>       Show all containers (default shows just running)</span></div><div class="line">  -<span class="ruby">-before=             Show only container created before Id <span class="keyword">or</span> Name</span></div><div class="line">  -<span class="ruby">f, --filter=[]       Filter output based on conditions provided</span></div><div class="line">  -<span class="ruby">-format=             Pretty-print containers using a Go template</span></div><div class="line">  -<span class="ruby">-help=<span class="literal">false</span>          Print usage</span></div><div class="line">  -<span class="ruby">l, --latest=<span class="literal">false</span>    Show the latest created container, <span class="keyword">include</span> non-running</span></div><div class="line">  -<span class="ruby">n=-<span class="number">1</span>                 Show n last created containers, <span class="keyword">include</span> non-running</span></div><div class="line">  -<span class="ruby">-no-trunc=<span class="literal">false</span>      Don<span class="string">'t truncate output</span></span></div><div class="line">  -<span class="ruby"><span class="string">q, --quiet=false     Only </span></span></div><div class="line"> numeric IDs</div><div class="line">  -<span class="ruby"><span class="string">s, --size=false      Display total file sizes</span></span></div><div class="line">  -<span class="ruby"><span class="string">-since=              Show created since Id or Name, include non-running</span></span></div></pre></td></tr></table></figure>
<p><strong>attach 连接已经启动的容器 / start -i 启动并连接容器</strong>：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker ps -a  #查看容器ID</span></div><div class="line">[root@centos7 ~]<span class="comment"># docker start &lt;CONTAINER ID&gt;	#启动容器</span></div><div class="line">[root@centos7 ~]<span class="comment"># docker attach &lt;CONTAINER ID&gt;	#连接容器，该容器必须是启动状态</span></div><div class="line">或者</div><div class="line">[root@centos7 ~]<span class="comment"># docker start -i &lt;CONTAINER ID&gt;		#启动并连接容器</span></div></pre></td></tr></table></figure>
<p><strong>注</strong>：但是使用 attach 命令有时候并不方便。当多个窗口同时 attach 到同一个容器的时候，所有窗口都会同步显示。当某个窗口因命令阻塞时,其他窗口也无法执行操作了。</p>
<p><strong>commit 将容器的状态保存为镜像</strong>：</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker commit c43c7d102baa ubhttp</span></div><div class="line">d47bbf8e50bace073de2b256b0360cfab029c11881f0d361fce7ae7464aa40ff</div><div class="line">[root@centos7 ~]<span class="comment"># docker images</span></div><div class="line">REPOSITORY          <span class="keyword">TAG</span>                 <span class="title">IMAGE</span> ID            CREATED             VIRTUAL SIZE</div><div class="line">ubhttp              latest              d47bbf8e50ba        <span class="number">54</span> seconds ago      <span class="number">248</span> MB</div><div class="line">docker.io/ubuntu    latest              <span class="number">8693</span>db7e8a00        <span class="number">7</span> days ago          <span class="number">187.9</span> MB</div><div class="line"><span class="comment">## 更为标准点的如下：</span></div><div class="line">$ sudo docker commit -m <span class="string">"Added json gem"</span> -a <span class="string">"Docker Newbee"</span> <span class="number">0</span>b2616b0e5a8 ouruser/sinatra:v2</div><div class="line">其中，-m 来指定提交的说明信息，跟我们使用的版本控制工具一样；-a 可以指定更新的用户信息；之后是用来创建镜像的容器的 ID；最后指定目标镜像的仓库名和 <span class="keyword">tag</span> <span class="title">信息。创建成功后会返回这个镜像的 ID</span> 信息。</div></pre></td></tr></table></figure>
<p><strong>diff 命令查看容器内的文件变化</strong>：</p>
<p>它可以列出容器内发生变化的文件和目录。这些变化包括添加（A-add）、删除（D-delete）、修改（C-change）</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[root<span class="title">@centos7</span> ~]# docker diff <span class="keyword">c</span><span class="number">43</span><span class="keyword">c</span><span class="number">7</span>d<span class="number">102</span>baa</div></pre></td></tr></table></figure>
<p><strong>cp 命令拷贝文件</strong>：</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#从docker中往本地拷贝文件</span></div><div class="line">[root@centos7 ~]<span class="comment"># docker cp c43c7d102baa:/var/www/html/index.html /opt/   </span></div><div class="line">[root@centos7 ~]<span class="comment"># ls /opt/</span></div><div class="line">index.html  rh</div><div class="line"><span class="comment"># 从本地往docker中拷贝文件</span></div><div class="line">[root@centos7 ~]<span class="comment"># docker cp aa c43c7d102baa:/var</span></div><div class="line">[root@centos7 ~]<span class="comment"># docker start -i c43c7d102baa</span></div><div class="line">root@<span class="symbol">c43c7d102baa:</span>/<span class="comment"># ls</span></div><div class="line">bin  boot  dev  etc  home  <span class="class"><span class="keyword">lib</span>  <span class="title">lib64</span>  <span class="title">media</span>  <span class="title">mnt</span>  <span class="title">opt</span>  <span class="title">proc</span>  <span class="title">root</span>  <span class="title">run</span>  <span class="title">sbin</span>  <span class="title">srv</span>  <span class="title">sys</span>  <span class="title">tmp</span>  <span class="title">usr</span>  <span class="title">var</span></span></div><div class="line">root@<span class="symbol">c43c7d102baa:</span>/<span class="comment"># ls var/</span></div><div class="line">aa  backups  cache  <span class="class"><span class="keyword">lib</span>  <span class="title">local</span>  <span class="title">lock</span>  <span class="title">log</span>  <span class="title">mail</span>  <span class="title">opt</span>  <span class="title">run</span>  <span class="title">spool</span>  <span class="title">tmp</span>  <span class="title">www</span></span></div></pre></td></tr></table></figure>
<p><strong>inspect 收集有关容器和镜像的底层信息</strong>：</p>
<p>Docker inspect命令可以收集有关容器和镜像的底层信息。这些信息包括：</p>
<ul>
<li>容器实例的IP地址</li>
<li>端口绑定列表</li>
<li>特定端口映射的搜索</li>
<li>收集配置的详细信息</li>
</ul>
<p>语法：</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker inspect <span class="keyword">container</span>/<span class="keyword">image</span></div></pre></td></tr></table></figure>
<p><strong>kill 命令发送sigkill信号停止容器的主进程</strong>：</p>
<p>语法：</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker kill [<span class="keyword">options</span>] <span class="symbol">&lt;container_id&gt;</span></div></pre></td></tr></table></figure>
<p><strong>rmi 移除一个或多个镜像</strong>：</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">docker rmi <span class="params">&lt;image_id&gt;</span></div><div class="line"><span class="meta">#注意：在删除镜像之前要先用 docker rm 删掉依赖于这个镜像的所有容器</span></div></pre></td></tr></table></figure>
<p><strong>wait 阻塞对指定容器的其它调用方法，直到容器停止后退出阻塞</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">docker wait <span class="tag">&lt;<span class="name">container_id</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>tag 修改镜像的标签</strong></p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker images </span></div><div class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</div><div class="line">&lt;none&gt;              &lt;none&gt;              f59c7e5b1817       <span class="number"> 18 </span>hours ago       <span class="number"> 192 </span>MB</div><div class="line">docker.io/ubuntu    latest              8693db7e8a00       <span class="number"> 7 </span>days ago          187.9 MB</div><div class="line">[root@centos7 ~]<span class="comment"># docker tag f59c7e5b1817 zwx/ub_mv:127 </span></div><div class="line">[root@centos7 ~]<span class="comment"># docker images </span></div><div class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</div><div class="line">zwx/ub_mv          <span class="number"> 127 </span>                f59c7e5b1817       <span class="number"> 18 </span>hours ago       <span class="number"> 192 </span>MB</div><div class="line">docker.io/ubuntu    latest              8693db7e8a00       <span class="number"> 7 </span>days ago          187.9 MB</div></pre></td></tr></table></figure>
<h2 id="docker的导入导出操作"><a href="#docker的导入导出操作" class="headerlink" title="docker的导入导出操作"></a>docker的导入导出操作</h2><p><strong>save 保存镜像为tar文件并发送到STDOUT</strong>:</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@node2 ~]<span class="comment"># docker images</span></div><div class="line">REPOSITORY          <span class="keyword">TAG</span>                 <span class="title">IMAGE</span> ID            CREATED             VIRTUAL SIZE</div><div class="line">zwx_ub              latest              f59c7e5b1817        <span class="number">7</span> seconds ago       <span class="number">192</span> MB</div><div class="line">ubuntu              latest              <span class="number">8693</span>db7e8a00        <span class="number">6</span> days ago          <span class="number">187.9</span> MB</div><div class="line">[root@node2 ~]<span class="comment"># docker save f59c7e5b1817 &gt;zwx_ub.tar</span></div><div class="line"><span class="comment"># 我将zwx_ub这个镜像导出成tar包，并拷贝到centos7的测试机中导入，导入过程在下边。</span></div></pre></td></tr></table></figure>
<p><strong>load 从tar文件中载入镜像或仓库到STDIN</strong>:</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># docker load -i zwx_ub.tar </span></div><div class="line">[root@centos7 ~]<span class="comment"># docker images </span></div><div class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE</div><div class="line">ubhttp              latest              d47bbf8e50ba        About an hour ago   <span class="number">248</span> MB</div><div class="line">&lt;none&gt;              &lt;none&gt;              f59c7e5b1817        <span class="number">16</span> hours ago        <span class="number">192</span> MB</div><div class="line">docker.io/ubuntu    latest              <span class="number">8693</span>db7e8a00        <span class="number">7</span> days ago          <span class="number">187.9</span> MB</div><div class="line">[root@centos7 ~]<span class="comment"># docker run -it f59c7e5b1817</span></div><div class="line">root@<span class="symbol">e17558664f8d:</span>/<span class="comment"># ls</span></div><div class="line">bin  boot  dev  etc  home  <span class="class"><span class="keyword">lib</span>  <span class="title">lib64</span>  <span class="title">media</span>  <span class="title">mnt</span>  <span class="title">opt</span>  <span class="title">proc</span>  <span class="title">root</span>  <span class="title">run</span>  <span class="title">sbin</span>  <span class="title">srv</span>  <span class="title">sys</span>  <span class="title">tmp</span>  <span class="title">usr</span>  <span class="title">var</span></span></div><div class="line">root@<span class="symbol">e17558664f8d:</span>/<span class="comment"># ls /mnt/</span></div><div class="line">zwx</div><div class="line"><span class="comment"># 可以看出，我导入zwx_ub这个镜像后，镜像ID并没有变化，我创建个容器并进入，发现打包前我创建的文件都在。</span></div></pre></td></tr></table></figure>
<p><strong>import 从本地文件系统导入一个镜像</strong></p>
<p>比如，先下载了一个 ubuntu-14.04 的镜像，之后使用以下命令导入<br>tar.gz的镜像可以在<code>http://openvz.org/Download/template/precreated</code>下载。</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># cat ubuntu-14.04-x86_64-minimal.tar.gz  |docker import - ubuntu:zwx</span></div><div class="line"><span class="number">23997</span>a971195cdd826f16a50573e480e1be1679729636178146425cdd46d1b52</div><div class="line">[root@centos7 ~]<span class="comment"># docker images </span></div><div class="line">REPOSITORY          <span class="keyword">TAG</span>                 <span class="title">IMAGE</span> ID            CREATED             VIRTUAL SIZE</div><div class="line">ubuntu              zwx                 <span class="number">23997</span>a971195        <span class="number">28</span> seconds ago      <span class="number">214.9</span> MB</div></pre></td></tr></table></figure>
<p><strong>export 容器的导出</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker ps</span></div><div class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</div><div class="line"><span class="number">16</span>f568766019        ubuntu              <span class="string">"/bin/bash"</span>         <span class="number">52</span> minutes ago      Up <span class="number">45</span> minutes                           elegant_mcclintock</div><div class="line">[root<span class="symbol">@centos7</span> ~]<span class="meta"># docker export 16f568766019 &gt;ubuntu.tar</span></div></pre></td></tr></table></figure>
<p><strong>import 容器的导入</strong>：</p>
<p>可以将容器的tar文件再导入为镜像</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ <span class="keyword">cat</span> ubuntu.tar | sudo docker import - <span class="keyword">test</span>/ubuntu:v1.0</div><div class="line">$ sudo docker images</div><div class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE</div><div class="line"><span class="keyword">test</span>/ubuntu         v1.0                9d37a6082e97        <span class="keyword">About</span> a minute ago   171.3 MB</div></pre></td></tr></table></figure>
<p>此外，也可以通过指定 URL 或者某个目录来导入，例如</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$sudo</span> docker import http:<span class="regexp">//</span>example.com<span class="regexp">/exampleimage.tgz example/im</span>agerepo</div></pre></td></tr></table></figure>
<p><strong>注</strong>：用户既可以使用 docker load 来导入镜像存储文件到本地镜像库，也可以使用 docker import 来导入一个容器快照到本地镜像库。这两者的区别在于容器快照文件将丢弃所有的历史记录和元数据信息（即仅保存容器当时的快照状态），而镜像存储文件将保存完整记录，体积也要大。此外，从容器快照文件导入时可以重新指定标签等元数据信息。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2016/12/15/Docker命令/" data-id="cixzx088b000ilx402r2u057d" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Docker/">Docker</a></div><div class="post-nav"><a href="/2016/12/15/ELK和filebeat的部署和简单应用/" class="pre">ELK + filebeat 日志分析工具的部署和简单应用</a><a href="/2016/12/15/Docker私有仓库/" class="next">Docker私有仓库</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Ansible/">Ansible</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ELK/">ELK</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gitlab/">Gitlab</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux命令/">Linux命令</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux工具/">Linux工具</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux系统/">Linux系统</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Nginx/">Nginx</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">46</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python爬虫/">Python爬虫</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SVN/">SVN</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zabbix/">Zabbix</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Log/" style="font-size: 15px;">Log</a> <a href="/tags/Ansible/" style="font-size: 15px;">Ansible</a> <a href="/tags/Docker/" style="font-size: 15px;">Docker</a> <a href="/tags/ELK/" style="font-size: 15px;">ELK</a> <a href="/tags/Gitlab/" style="font-size: 15px;">Gitlab</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Gitlab，Git/" style="font-size: 15px;">Gitlab，Git</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/inode/" style="font-size: 15px;">inode</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/Python-模块/" style="font-size: 15px;">Python 模块</a> <a href="/tags/Logrotate/" style="font-size: 15px;">Logrotate</a> <a href="/tags/Anisble/" style="font-size: 15px;">Anisble</a> <a href="/tags/VPN/" style="font-size: 15px;">VPN</a> <a href="/tags/Python模块/" style="font-size: 15px;">Python模块</a> <a href="/tags/PythonScrapy/" style="font-size: 15px;">PythonScrapy</a> <a href="/tags/collections/" style="font-size: 15px;">collections</a> <a href="/tags/Python语法/" style="font-size: 15px;">Python语法</a> <a href="/tags/Python爬虫/" style="font-size: 15px;">Python爬虫</a> <a href="/tags/递归/" style="font-size: 15px;">递归</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/Tcpdump/" style="font-size: 15px;">Tcpdump</a> <a href="/tags/Strace/" style="font-size: 15px;">Strace</a> <a href="/tags/SVN/" style="font-size: 15px;">SVN</a> <a href="/tags/Zabbix/" style="font-size: 15px;">Zabbix</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/Python-paramiko模块/">Python_paramiko模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/16/Python-ConfigParser模块/">Python_ConfigParser模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/Python-collections模块-deque/">Python_collections模块--deque</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/Python-collections模块-nametuple/">Python_collections模块--nametuple</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/Python-collections模块-defaultdict/">Python_collections模块--defaultdict</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/Python-collections模块-OrderedDict/">Python_collections模块--OrderedDict</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/09/Python-collections模块-Counter/">Python_collections模块--Counter</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/Python-Scrapy入门/">Python_Scrapy入门</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/Python-Scrapy命令行工具/">Python_Scrapy命令行工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/Python-网络爬虫初识/">Python_网络爬虫初识</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://luxinle.github.io/" title="卢会军的技术博客" target="_blank">卢会军的技术博客</a><ul></ul><a href="http://qinyueming.cc/" title="秦悦明的技术博客" target="_blank">秦悦明的技术博客</a><ul></ul><a href="http://www.jianshu.com/users/a4a7b9d0c23e/latest_articles" title="我的简书" target="_blank">我的简书</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">SateZheng.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>